---
title: "Logical variables"
subtitle: "STAT486/586"
author: "Xiongtao Dai"
output:
  xaringan::moon_reader:
    css: [myslides.css, myslides-fonts.css]
    lib_dir: libs
    nature:
      beforeInit: "macros.js"
      highlightLines: true
      countIncrementalSlides: false
---
class: big, middle

```{r xaringan-tile-view, echo=FALSE}
xaringanExtra::use_tile_view()
```

## Logical variables

---

## Logical vectors

- Vectors consisting of values `TRUE` and `FALSE`

- `&` and `|` are the logical *and* and *or*

- `!` is the logical negation

- `<, >, ==, !=, <=, >=` are comparison operators that returns a logical vector

- use parentheses `()` when linking expressions to avoid mis-interpretation

- `x %in% c(1, 3, 5)` tells whether each element of `x` is one of `c(1, 3, 5)`

- `ifelse` assigns values in a vector according to a logical variable

---

## Logical Operations

<img class="cover" src="images/logical.png" alt="" width=2000>

---

## R demo...

---
class: inverse

## Your turn


Define a vector: `a <- c(1, 15, 3, 20, 5, 8, 9, 10, 1, 3)`

Create logical vectors to indicate which entries in  `a` are:

<img src="images/green.png" width=20> less than 20<br/>

<img src="images/green.png" width=20> squared value is either at least 100 or less than 10<br/>

<img src="images/green.png" width=20> equals 1 or 3 or 5<br/>

<img src="images/green.png" width=20> even. 
  Hint: have a look at the help for the operator `%%`

---

## Subsetting Data Frames
```{r}
library(classdata)
Iowa2009 <- fbi[fbi$State == 'Iowa' & fbi$Year == 2009, ]
str(Iowa2009)
```

<!-- Other useful functions for subsetting data frames are `subset` and `dplyr::filter` (later) -->

---

## Updating elements in a data set

Data sets and their parts can be used as the left hand side (LHS) of an assignment:

```{r}
fbi$State[fbi$State == 'Iowa'] <- 'Our State'
unique(fbi$State)[10:20]
```

```{r}
# Round the population to nearest thousands
fbi$Population <- signif(fbi$Population, 3)
str(fbi$Population)
```
If that column exists before, it is being over-written/updated. It is a good idea to work on a copy of the data frame in case anything is messed up

---

## R demo...

---
class: inverse 

## Your turn

Work on the `fbi` dataset

<img src="images/green.png" width=20> Get a subset of all crimes in Iowa in 2009 and 2010. How many rows do you have?

<img src="images/blue.png" width=20> Get a subset of all violent crimes in 2009 for Iowa and 3 of its neighboring states. Visualize the crime rate for one type of crime. (Hint: Take out the crime rate, name it according to the state, and use `barplot`)

<img src="images/blue.png" width=20> Change the state name of California to "the Golden State"

<img src="images/black.png" width=20> Get a subset of the data that includes number of murders for the last five years. Find the murder rates, extract all states that have a rate of greater than 90% of the rates across all states, and plot (Hint: `?quantile`).

---

## Missing values in R

- `NA` is the special code for "not available"
- R consistently handles mising values. Eg. we get 
```{r}
NA + 1
```

```{r}
NA | TRUE
```
- Caution: Direct testing for missing values with `==` will result in an `NA`:
```{r}
x <- c(1, NA)
x == NA
```
<!-- - `NaN` is the code for "not a number", e.g. in 0/0 -->

---

## Essential functions 

- Use function `is.na` for testing `NA`s
```{r}
x <- c(1, NA)
is.na(x)
```

- `complete.cases(data)` test the existence of `NA`s in the rows of data frames
<!-- - `drop_na(data, col1, ...)` drops the rows if `NA`s exist in `col1` or additional columns -->

---

## Handling missing values

There are a few principles for handing missing values. 

- Errors in the dataset should be removed

- If uncertain whether missing values are due to errors, perform analysis with as little distortion to the data as possible

- Performing a sensitivity analysis is a good idea: One version with missing values, and the other without. Compare the results.

---

## R demo...

---
class: inverse

## Your turn

<img src="images/green.png" width=20> What does `2 * NA` give you? Why

<img src="images/green.png" width=20> What does `NA & FALSE` give you? Why
